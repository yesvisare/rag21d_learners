# M2.4 â€” Error Handling & Reliability Configuration
# Copy this file to .env and fill in your values

# ==================== API KEYS ====================
OPENAI_API_KEY=sk-your-api-key-here

# ==================== TIMEOUT SETTINGS ====================
# All timeouts in seconds
OPENAI_TIMEOUT=30.0
VECTOR_DB_TIMEOUT=10.0
EMBEDDING_TIMEOUT=15.0
COMPLETION_TIMEOUT=30.0

# ==================== RETRY CONFIGURATION ====================
# General retry settings
RETRY_MAX_ATTEMPTS=3
RETRY_INITIAL_DELAY=1.0
RETRY_EXPONENTIAL_BASE=2.0
RETRY_ENABLE_JITTER=true

# Operation-specific retry settings
EMBEDDING_MAX_RETRIES=3
EMBEDDING_INITIAL_DELAY=1.0
COMPLETION_MAX_RETRIES=2
COMPLETION_INITIAL_DELAY=2.0

# ==================== CIRCUIT BREAKER ====================
# Failure threshold before opening circuit
CB_FAILURE_THRESHOLD=5

# Time to wait before attempting recovery (seconds)
CB_RECOVERY_TIMEOUT=60.0

# Max test calls in HALF_OPEN state
CB_HALF_OPEN_MAX_CALLS=1

# ==================== REQUEST QUEUE ====================
# Maximum queue size (prevent memory exhaustion)
QUEUE_MAX_SIZE=1000

# Worker sleep time when queue is empty (seconds)
QUEUE_WORKER_SLEEP=0.1

# Alert thresholds
QUEUE_WARNING_THRESHOLD=750   # 75% capacity
QUEUE_CRITICAL_THRESHOLD=950  # 95% capacity

# ==================== CACHE SETTINGS ====================
# Cache settings for fallback responses
CACHE_MAX_AGE=3600    # 1 hour in seconds
CACHE_MAX_SIZE=100    # Max number of cached items

# ==================== LOGGING & MONITORING ====================
# Log level: DEBUG, INFO, WARNING, ERROR, CRITICAL
LOG_LEVEL=INFO

# Enable metrics collection
ENABLE_METRICS=false
METRICS_INTERVAL=60  # Collection interval in seconds

# ==================== FEATURE FLAGS ====================
# Enable/disable specific resilience features
ENABLE_RETRIES=true
ENABLE_CIRCUIT_BREAKER=true
ENABLE_FALLBACKS=true
ENABLE_QUEUEING=true

# ==================== PRODUCTION TUNING NOTES ====================
#
# Conservative settings (high reliability, slower recovery):
#   CB_FAILURE_THRESHOLD=3
#   CB_RECOVERY_TIMEOUT=120.0
#   RETRY_MAX_ATTEMPTS=5
#
# Aggressive settings (faster recovery, more risk):
#   CB_FAILURE_THRESHOLD=10
#   CB_RECOVERY_TIMEOUT=30.0
#   RETRY_MAX_ATTEMPTS=2
#
# Cost-optimized settings (reduce retry costs):
#   EMBEDDING_MAX_RETRIES=2
#   COMPLETION_MAX_RETRIES=1
#   RETRY_INITIAL_DELAY=2.0
